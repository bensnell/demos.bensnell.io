<!DOCTYPE html>
<html lang="">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<head>  
  <title>Cattleya by Ben Snell</title>
  <style>
    body {
      background: #FFF;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: row;
      margin: 0
    }
    canvas {
      margin: auto;
      display: block;
    }
    body.dark-theme {
      background: #000;
    }
  </style>
</head>

<body>
  <script>
    // Turn on dark color scheme if preferred by user.
    // https://css-tricks.com/a-complete-guide-to-dark-mode-on-the-web/
    const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
    if (prefersDarkScheme.matches) {
      document.body.classList.add("dark-theme");
    } else {
      document.body.classList.remove("dark-theme");
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"></script>
  <script>
    //TOKEN_DATA_BEGIN//
function random_hash() {
  let x = "0123456789abcdef", hash = '0x'
  for (let i = 64; i > 0; --i) {
    hash += x[Math.floor(Math.random() * x.length)]
  }
  return hash;
};

if (!this.tokenData) this.tokenData = {};
//INSERT_USER_TOKEN_DATA//
if (!('tokenId' in tokenData)) tokenData.tokenId = "123000456";
if (!('hash' in tokenData)) tokenData.hash = random_hash();    
    //TOKEN_DATA_END//
  </script>
  <script>
    // If the hash is passed as a url parameter, then set it.
    // https://www.sitepoint.com/get-url-parameters-with-javascript/
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has("hash")) tokenData.hash = urlParams.get("hash");
  </script>
  <script>
    // Cattleya Â© 2022 by Ben Snell is licensed under CC BY-NC 4.0.
    // (Cattleya is both the name of this code and its outputs.)
    // https://creativecommons.org/licenses/by-nc/4.0

    //APP_BEGIN//
var META="Ben Snell_Cattleya_1.3.7",A=this.Math,C=(FL=A.floor,CL=A.ceil,RD=A.round,IO=(t,r)=>t instanceof r,[I,X]=[A.min,A.max].map(r=>(...t)=>r(...t.flat())),W=window.innerWidth,H=window.innerHeight,D=I(W,H),EP=Number.EPSILON,O=0,LC=0,(t,r=0,s=1)=>(s<r&&([r,s]=[s,r]),X(I(t,s),r))),V=(t,r,s)=>createVector(t,r,s),L=(t,r,s=null)=>(null==s&&(s=r,r=t[1],t=t[0]),lerp(t,r,s)),WR=(t,r)=>(t+CL(abs(t/r))*r)%r,g=(XR=(t,r)=>(t||r)&&!(t&&r),MM=(...t)=>[I(...t),X(...t)],WP=(t,r,s)=>(t=WR(t,s),r=WR(r,s),[c,d]=MM(t,r),q=d-c>s/2,[q?d-s:c,q?c:d,XR(t==d,q)]),LW=(t,r,s,p)=>([c,d,f]=WP(t,r,p),WR(L(c,d,f?1-s:s),p)),WD=(t,r,s)=>([c,d,f]=WP(t,r,s),(c-d)*(f?-1:1)),N=t=>Array(t).fill(0).p((t,r)=>r),N2=(t,s)=>N(t).p(r=>N(s).p(t=>[r,t])).flat(),N3=(t,r,p)=>N(t).p(s=>N(r).p(r=>N(p).p(t=>[s,r,t]))).flat().flat(),E=t=>Object.entries(t),K=t=>Object.keys(t),Y=(t,r)=>{let p=t=>n((t=>IO(t,Function)?t:JSON.parse(JSON.stringify(t)))(t),t),n=(s,t)=>(IO(s,Object)&&IO(t,Object)&&E(t).map(([t,r])=>{n(s[t],r),null==s[t]&&(s[t]=p(r))}),s);return n(p(t),r)},SW=(t,r,s)=>[t[r],t[s]]=[t[s],t[r]],p=p5.Vector.prototype,p.ar=function(){return this.array()},p.r=function(t,r){var s=this,r=r/2,p=sin(r),n=t.x*p,e=t.y*p,p=t.z*p,r=cos(r),t=s.x,a=s.y,i=s.z,o=r*t+e*i-p*a,l=r*a+p*t-n*i,u=r*i+n*a-e*t,t=-n*t-e*a-p*i;return s.x=o*r+t*-n+l*-p-u*-e,s.y=l*r+t*-e+u*-n-o*-p,s.z=u*r+t*-p+o*-e-l*-n,s},p.c=function(){return this.copy()},p.n=function(t=0){return(t?this.c():this).normalize()},p.s=function(t){return this.cross(t)},p.a=function(t){return this.add(t)},p.m=function(t){return null==t?this.mag():this.setMag(t)},p.j=function(t,r=0){t=t.n(1).m(t.n(1).dot(this));return this.set(r?this.sub(t):t)},p.l=function(t){return 1==t?abs(this.x)+abs(this.y)+abs(this.z):this.mag()},p.e=function(t=1){var r=this.n(),s=r.ar();return SW(s,1,t),s=[atan2(s[2],sqrt(s[0]**2+s[1]**2)),0,-atan2(s[0],s[1])],SW(s,1,t),r.set(s),r},p.b=function(t){return this.m()>EP&&t.m()>EP?this.angleBetween(t):0},p.o=function(t=null){var r=this,s=(-r.x-r.y)/r.z,t=t&&t.m()>EP&&1-abs(r.n(1).dot(t.n(1)))>EP?t:V(1,1,isFinite(s)?s:1);return r.s(t).n()},p.sl=function(t,r){var[t,r,s]=this.m()<=EP?[t,this,1-r]:[this,t,r];return this.set(t.r(t.n(1).o(r),abs(r.n(1).b(t))*s).m(L(t.m(),r.m(),s)))},p5.prototype),s=(g.t=function(t,r,s){return this.translate(t,r,s)},g.u=function(){return this.push()},g.o=function(){return this.pop()},g.k=function(t,r,s){return this.scale(t,r,s)},G=(t,r=D,s=D,p=0)=>{r=createGraphics(r,s,t?WEBGL:P2D);return p&&r.pixelDensity(p),r.colorMode(RGB,1),r.noStroke(),r.clear(),r},T=(t,r)=>{var s=t.width,p=t.height,n=I(s,p);t.u(),IO(t._renderer.drawingContext,CanvasRenderingContext2D)&&t.t((s-n)/2,(p-n)/2),t.k(n),r(t),t.o()},p5.Shader.prototype),a=(s.u=function(t,r){return this.setUniform(t,r)},CS=(t,r)=>new p5.Shader(void 0,"attribute vec3 aPosition;attribute vec2 aTexCoord;varying vec2 X;"+t,"precision mediump float;varying vec2 X;\n"+r),D2R=A.PI/180,PHI=(1+A.sqrt(5))/2,NN=(t,r=0)=>t||r,MD=(t,r)=>(t+abs(FL(t/r))*r)%r,ZS=0,ZO=4,ZF=.5,Z=(t,r,s)=>(IO(t,p5.Vector)&&([t,r,s]=t.ar()),noiseDetail(ZO,ZF),2*noise(t+ZS,r,s)-1),SD=(t,r)=>r<EP?0:t/r,SZ=(t,r,s=1)=>pow(C(1-r-cos(PI/2*(t+r))),r?1/s:s),U=(t,r)=>[r].ft().r((t,r)=>t[r],t),Array.prototype),CC=(a.p=function(t){return this.map(t)},a.l=function(){return this.length},a.at=function(t){var r=this.l();return 0==r?0:this[WR(int(t),r)]},a.cs=function(){var s=[];return this.r((t,r)=>(s.push(t+r),t+r)),s},a.ii=function(t){for(var r=this,s=0,p=r.l();s+2<p&&r[s+1]<t;)s++;return p<2?0:s+C((t-r[s])/(r[s+1]-r[s]))},a.iiw=function(t,r=1){t=[0].concat(this.p(t=>[t/2,t/2]).flat()).cs().ii(this.cs().at(-1)*t);return(int(t)+SZ(t%1,1-int(t)%2,r)-1)/2},a.ft=function(t=1/0){for(var r=this;t--&&r.some(t=>IO(t,Array));)r=r.flat();return r},a.st=function(s,p=1){return this.sort((t,r)=>U(p?t:r,s)-U(p?r:t,s))},a.r=function(t,r=0){return this.reduce(t,r)},SM=t=>t.r((t,r)=>t+r),SH=(s,t=0)=>("string"==typeof s?N(s.length).r((t,r)=>t+s.charCodeAt(r)*31**r):s)*31**t,PW=(t,r)=>pow(abs(t),r)*A.sign(t),BZ=(t,s,p,e,a)=>N(a+1).p(n=>V().set(N(3).p(r=>[t,s,p,e].p(t=>t.ar()[r])).p(([t,r,s,p])=>bezierPoint(t,r,s,p,n/a)))),HX=t=>"#"+hex(Y(t.levels).splice(0,3),2).join(""),CM=(t,r,s,p=1)=>{t=s.iiw(t,p),p=FL(t);return HX(LC(O(r[WR(p,s.l())]),O(r[WR(p+1,s.l())]),C(t-p)))},LG=(t,r=10)=>log(t)/log(r),P=(t,r,s=1,p=0,n=1,e=1)=>map(t,r,s,p,n,e),UZ=s=>s&&IO(s[0],Array)?s[0].p((t,r)=>s.p(t=>t[r])):s,LI=t=>t.p(t=>[lightness(t),t]).st(0,0)[0][1],IN=(t,r=1)=>r?1-t:t,WA=(t,p,n)=>WR(NN(atan2(...[sin,cos].p(s=>SM(t.p((t,r)=>s(WR(t,p)/p*2*PI)*(n?n[r]:1)))/t.l()/(n?SM(n):t.l())))),2*PI)/2/PI*p,SF=(t,r)=>{let s,p,n=(t=r?t:t.slice()).l();for(;1<n;)s=R.d()*n|0,p=t[--n],t[n]=t[s],t[s]=p;return t},LU=t=>sqrt(.299*red(t)**2+.587*green(t)**2+.114*blue(t)**2),GR=(r,p,n,s=[0,0,1,1,0],e=null,a=100)=>{T(r,()=>{e=e||[(s[0]+s[2])/2,(s[1]+s[3])/2,0,0,1];let t=UZ([s,e]);N(a).p(s=>{r.fill(LC(p,n,s/a)),r.rect(...t.p(([t,r])=>lerp(t,r,s/a)))})})},AL=(t,r)=>{var s=lightness(t)/100,p=r<0?0:1;return LC(O(t),O(p),P(s+r,s,p))},p5.ColorConversion);VB=t=>{var[,t,r]=CC._rgbaToHSBA(O(t)._array);return t*r};class RNG{constructor(){var r=this;r.U=!1;function s(r){let[s,p,n,e]=[0,8,16,24].map(t=>parseInt(r.substr(t,8),16));return function(){s|=0,p|=0,n|=0,e|=0;var t=(s+p|0)+e|0;return e=e+1|0,s=p^p>>>9,p=n+(n<<3)|0,n=n<<21|n>>>11,n=n+t|0,(t>>>0)/4294967296}}[r.A,r.B]=[2,34].map(t=>new s(tokenData.hash.substr(t,32)));for(let t=0;t<1e6;t+=2)r.A(),r.B()}d(){var t=this;return t.U=!t.U,t.U?t.A():t.B()}n(t,r){return t+(r-t)*this.d()}i(t,r){return FL(this.n(t,r+1))}g(t=0,r=1,s=1,p=1){let n=0,e=0,a;for(;0===n;)n=this.d();for(;0===e;)e=this.d();return(a=sqrt(-2*log(n))*cos(2*PI*e))*[0<a?p:s]*r+t}}class BL{S(t=D,r=D,s=0){var p=this;return p.f=t,p.g=r,p.a=G(1,t,r,s),p.b=G(1,t,r,s),["h","v"].p(t=>p[t]=CS("void main(){X = aTexCoord;vec4 p=vec4(aPosition,1.);p.xy=p.xy*2.-1.;gl_Position=p;}","uniform vec2 R,D;uniform sampler2D tex0;uniform vec4 F;vec4 L(vec4 s,vec4 t){float a=t.a+s.a*(1.-t.a);return vec4((t.rgb*t.a+s.rgb*s.a*(1.-t.a))/a,a);}vec4 U(vec4 c){return floor(c*255.+vec4(.5))/255.;}void main(){vec4 o=vec4(0.,1.411764705,3.294117647,5.176470588),w=vec4(.1964825502,.2969069646,.09447039785,.0103813624),c=vec4(0.),l;float e,t,b,s=0.;for(int i=0;i<4;i++){for(int j=-1;j<2;j+=2){e = float(i != 0 || j != 1);l=texture2D(tex0,vec2(X.x,1.-X.y)+vec2(o[i])*D/R*float(j));t=w[i]*l.a;s+=t*e;c+=vec4(l.rgb*t,l.a/7.)*e;}}b=float(s<1e-5);s=b+s*(1.-b);c/=s;gl_FragColor=U(L(U(c),F));}")),p}A(r,t,s,p,n=[0,0,0,0]){var e=this,a=e.a,i=e.b,u=e.h,c=e.v,o=e.f,l=e.g;a.clear(),i.clear(),N(p).p(t=>{[[a,u,0==t?r:i,[s,0],i,[0,0,0,0]],[i,c,a,[0,s],a,n]].p(t=>{var[t,r,s,p,n,e]=t;t.shader(r),r.u("R",[o,l]),r.u("tex0",s),r.u("D",p),r.u("F",e),t.rect(0,0,o,l),n.resetShader(),n.clear(),t.resetShader()})}),t.clear(),T(t,function(t){t.k(1,_F?-1:1),t.image(i,0,_F?-1:0,1,1)})}P(r,s,p=1,n=1){return this.p=N(s).p(t=>FL(n*pow(exp(1),pow(t/s,p)*log(r)))),this.p}D(){var r=this;["a","b"].p(t=>{r[t].remove(),r[t]=null})}}class BB{constructor(t,r){this.b=0,this.i=V(),this.x=V(),t&&this.a(r?[t.c().sub(r,r,r),t.c().add(r,r,r)]:t)}a(p){p=[p].ft();var n=this;return[["i",I],["x",X]].p(([s,t])=>n[s].set(["x","y","z"].p(r=>t(...p.p(t=>(IO(p[0],BB)?t[s]:t)[r]).concat(n.b?[n[s][r]]:[]))))),n.b=1,n}t(t,r=0){t=r?t.c().mult(-1):t;return this.i.a(t),this.x.a(t),this}s(t,r=0){return this.i.mult(t=r?1/t:t),this.x.mult(t),this}c(){this.b=0}o(){return this.i.c().a(this.x).div(2)}d(){return this.x.c().sub(this.i)}n(t=0){let s=this,r=s.d().div(2).ar(),p=SM(r)/3,n=s.o();return t?[s.n().p(t=>t.m(p)),N2(3,2).p(([s,p])=>n.c().a(V(...r.p((t,r)=>s==r?t*(2*p-1):0))))].ft():N3(2,2,2).p(t=>V(...t.p((t,r)=>(0<t?s.x:s.i).ar()[r])))}}var SFP={c:[[.24,-.154,0,-.199,-.138,0,-.186,-.01,0,-.3,-.205,-.101,.277,.242,-.21,0,.297,-.198,-.222,.274,.141,-.014,0,.254,.077,-.202,0,.063,-.216,.263],[-.176,.149,0,-.215,.313,0,.174,-.185,0,-.019,-.257,.293,.022,.121,-.073,0,-.018,-.265,.182,.074,.266,-.226,0,-.071,-.316,.286,0,.256,-.27,-.095],[.11,-.052,0,.071,-.165,0,.032,-.436,0,.05,.035,-.276,.076,-.08,-.329,0,-.077,-.088,.228,.054,-.287,-.419,0,-.174,-.278,-.024,0,-.319,.01,.156],[-.215,.487,0,-.277,-.107,0,-.402,.185,0,.015,-.14,-.075,.189,-.2,.185,0,-.063,-.088,-.159,.238,-.074,-.082,0,-.26,-.037,-.081,0,-.272,-.076,-.189]],m:[38.667,9.333,1,.55,.458,0,82.5,4.167,0,.975,.517,.45,124.167,105,-2.5,0,1.108,.483,.7,76.667,80,25,0,1.133,.583,1.058,180,64.167,-16.667,.175],s:[13.683,5.558,0,.096,.13,0,24.281,26.047,0,.056,.134,.096,25.887,24.833,36.027,0,.335,.195,.361,21.922,16.33,27.538,0,.189,.195,.292,0,30.743,83.15,.258],t:[[-2.02,-2.098,-2.032,-.919],[-1.603,-.042,-2.623,.355],[-1.763,5.141,.864,-.903],[-1.172,-.449,1.329,2.985],[7.344,.274,-.405,-.071],[-.786,-2.827,2.867,-1.447]],q:[1.8,1.5,1.5,1.5],fnct:function(n){return{r:X(n.splice(0,1),20),n:X(CL(n.splice(0,1)),1),p:N(4).p(s=>{var p={};return["l","r","w","t","a","b","d"].p((t,r)=>{p[t]=X(n[7*s+r],r<3||5<r?1e-5:-1e9)}),p})}}},SPP={c:[[-.326,.352,.045,.284,.13,-.278,.368,.089,.068,.197,.291,-.324,.204,.023,-.075,-.148,.278,.205,.053,.112,-.096,-.05,.006,.02],[-.108,-.014,.278,-.206,.146,-.002,-.088,.264,.135,.123,.197,-.027,-.269,-.099,.247,-.283,-.071,-.287,-.02,.349,.249,.073,.362,.256],[-.155,.151,.244,.003,.061,.053,-.076,-.297,-.187,-.215,.025,-.115,-.288,.375,.377,-.021,.137,.2,-.33,.03,.254,.068,-.204,-.231],[-.059,.072,.077,.047,-.33,-.341,.177,-.101,-.037,.377,-.257,.067,.044,.185,-.006,-.139,-.303,-.166,.124,-.147,.27,.442,-.002,-.148],[-.182,-.209,-.291,-.284,.326,-.042,-.063,.181,.466,.048,-.045,-.171,.061,.294,-.035,.027,-.051,.123,-.065,-.257,.143,-.015,.196,-.35],[-.134,-.066,.18,-.153,.039,.248,-.045,.166,-.164,-.001,-.04,-.325,.029,.008,.059,.457,.218,.039,.511,-.066,.078,.388,-.048,.094]],m:[9.75,7.25,2.812,1.875,7.062,.625,.644,.774,1.062,.347,.731,.781,.204,.509,.163,.249,.096,.062,.488,.5,333.75,35.25,1.331,.594],s:[6.759,3.631,.998,1.965,5.282,.484,.346,.401,.39,.127,.236,.522,.114,.089,.178,.188,.041,.027,.154,.354,191.307,13.245,.538,.288],t:[[-.1,2.154,2.157,-.673,-1.189,.314],[3.239,.74,-2.192,-.172,2.814,-1.188],[-.702,2.277,.953,4.16,.213,-.023],[3.933,-2.971,.402,.438,-2.565,-.526],[-.953,-2.439,-1.608,.447,.728,2.92],[-2.232,-2.725,3.208,-1.038,1.869,-.964],[-3.899,-.126,-3.06,-.445,-1.561,-1.505],[.714,3.089,.14,-2.717,-.309,.972]],q:[2.62,2.453,2.164,1.958,1.793,1.437],fnct:function(s){var p={};return["qpa","qlm","qlg","qs","qfs","bu","am","bm","eba","lmm","eli","ela","wlf","rl","dlm","htf","wtf","dtf","rt","olb","ll","rf","lsf","us"].p((t,r)=>p[t]=X(abs(s[r]),1e-5)),p}};class SSM{constructor(r){K(r).p(t=>this[t]=r[t])}l(){return this.c.l()}f(){return this.c[0].l()}G(t=0){let n=this,r=R.d()<t?n.t[R.i(0,n.t.l()-1)].p((t,r)=>t+R.g(0,n.q[r]/3)):N(n.l()).p(t=>R.g(0,n.q[t])),s=n.fnct(N(n.f()).p(p=>r.r((t,r,s)=>t+r*n.c[s][p])*n.s[p]+n.m[p]));return s._d=r,s}}class PTP{constructor(){this.t={},this.n=8}H(p){return RD(K(p).sort().p(s=>IO(p[s],Function)?N2(2,2).p(([t,r])=>p[s](t/2,r/2)):p[s]).ft().r((t,r,s)=>t+SH(r,s)%1e4))}X(t){var t=Y(t,{s:100,l:2,d:t=>1,f:(t,r)=>r,n:(t,r)=>0,w:0,r:[0,1],b:0,u:1,m:8,o:4,a:.5}),r=this.H(t),s=this.t;return(a=s[r]=s[r]||[]).l()<(t.m||this.n)&&a.push(this.G(t)),a[R.i(0,a.l()-1)]}G(a){ZS=1e4*R.d(),ZO=a.o,ZF=a.a;var s=a.s,p=G(0,s,s,1),i=100*R.d();return p.loadPixels(),N2(s,s).p(([t,r])=>p.set(t,r,(a.e?(t,r)=>{var s=Z(t,r+3+i),p=Z(t,r+i),t=Z(t+3,r+i),[r,n,e]=a.e;return O(X(C(abs(s)*r+r),C(.1*s+.1)*P(n,-.1,0)),C(.5-abs(p)/2+n),X(C(abs(t)*e+e),C(t)*P(e,0,.2,.7)))}:(t,r)=>{var s=2*abs(atan2(t-.5,r))/PI,t=SD(V(t,r).sub(.5).l(a.l),a.d(s)),r=a.f(s,t)+a.n(s,t),s=a.c.l(),r=a.w?.999*C(1<a.w?L(a.r,MD(r,1)):MD(L(a.r,r),1)):L(a.r,.999*C(r));return O(a.c[C(FL(r*s),0,s-1)])})((t+.5)/s,(r+.5)/s))),p.updatePixels(),a.b&&B[s].A(p,p,s/100*a.u,a.b),ZS=0,ZO=4,ZF=.5,p}}class PE{constructor(t,r,s=1,p=0,n=0,e=1){var a=this;a.ot=V(),a.i=[[2,3,0],[2,0,1],[2,1,4],[2,4,3],[0,5,1],[0,3,6],[0,16,15],[16,0,5],[5,10,16],[10,5,6],[6,15,10],[15,6,0]],a.v=[],a.t=[V(.5),V(0,.5),V(.5,.5),V(1,.5),V(.5,1),V(),V(1)],a.tt=N(6).p(r=>N(3).p(t=>V(1-(FL(r/2)+(t+r%2)%2)/3,0==t?1-r%2:r%2))),a.sn=1,PE.tp||(PE.tp=new PTP),a.p=t,a.os=e,a.n=4+2*int(p)+6*int(n),a.I(),null!=s&&a.U(s),a.tex=PE.tp.X(r)}I(){N(this.n).p(t=>{this.v.push(V())})}V(t){var r=10<=t?this.p.lp:this;return r.v[t%10].c().a(r.ot.c().sub(this.ot))}T(t,r){return 5<t?this.tt[t-6][r]:this.t[this.i[t][r]]}U(t){var r=this,s=r.p,p=(r.age=t,C(t+1)),n=(t=X(0,t),L(s.r,t)),e=s.l*p,a=e*n,n=e*(1-n),p=s.w*p/2,i=s.x.n(1),o=i.s(s.u.n(1).r(i,s.t)),u=o.s(i),l=L(s.a,t),c=L(-2*s.a[0],s.b,t),f=s.d,l=i.c().mult(a).r(o,l),e=s.rc||X(e/2,a),a=l.c().sub(l.c().j(i)).m(e),p=I(SD(p,e)*(t/2+.5),PI),e=a.c().r(i,p).sub(a),p=a.c().mult(-1).m(e.m()),a=(1-f)*abs(p.b(e)),f=NN(s.wt*t),e=NN(s.dt*t),b=NN(atan(e/2/f)),h=NN(sqrt(f**2+(e/2)**2)),d=i.c().m(NN(s.ht*t)/4);r.v=[V(),p.c().r(i,a).a(l),l.c(),p.c().r(i,-a).a(l),l.c().r(o,c).m(n).a(l)].concat(r.n<=5?[]:N(2).p(t=>u.c().r(i,PI+(t?-1:1)*b).m(h).a(d))).p(t=>t.mult(r.sn))}D(p,n,e){var a=this;a.age!=(a.fw?-1:0)&&(p.u(),p.k(a.os),p.t(a.ot),e&&p.texture(n?a.tex:_X),p.beginShape(TRIANGLES),N(a.n).p(s=>{a.i[s].p((t,r)=>{r=a.T(s,r),r=e?n?[r.x*a.tex.width,r.y*a.tex.height]:[r.x*_X.width,r.y*_X.height]:[];p.vertex(...a.V(t).ar(),...r)})}),p.endShape(CLOSE),p.o())}B(t=0){var r=this,s=N(r.n).p(t=>r.i[t].p(t=>r.V(t%10)));return new BB(0==t?s:V(),0==t?null:s.ft().r((t,r)=>max(t,r.m()))).t(r.ot).s(r.os)}}PE.tp=null;class PA{constructor(t,r){var s=this;s.c=N(t).p(t=>CM(R.d(),"fff,efc,6e4,ff2,fe2,fb5,f90,f10,d00,e03,400,404,406,a0c,f4b".split(",").p(t=>"#"+t),[6,3,2,3,1,1,1,1,2,1,1,1,2,1,3]));let p=(s=.3,p=100,n=1)=>(t,r)=>Z(t*p,r*p*n)*s;s.ti=R.i(0,11),s.tp=[[{n:p(.5),r:[.2,.81]},{d:t=>1-t,f:(t,r)=>r-t,n:p(),r:[0,.85]},{l:1,d:t=>C(1.5-t),n:(t,r)=>Z(40*t,r)+p()(t,r),r:[.1,.81]}],[{l:1,d:t=>1-t,f:(t,r)=>r-t+.2,n:p(.3,50,.02)},{l:1,d:t=>1-t,f:(t,r)=>1-t,n:p(),r:[.2,1],b:1},{d:t=>sqrt(1-t),f:(t,r)=>PW(C(1-r+2*t),.5),n:p(),r:[.5,1],b:1}],[{d:t=>(1+t)/2,f:(t,r)=>C(1-atan2(t,r-.7)/PI),n:(t,r)=>p(t)(t,r),b:10},{n:(t,r)=>p(1)(t,r)*(t/2+.5),r:[1/3,1],b:10},{n:p(1),r:[1/3,.75],b:10}],[{d:t=>PW(1-C(2*t),.3),f:(t,r)=>C(r-t),n:p(.5),r:[.33,1],b:1},{f:(t,r)=>1-r,n:(t,r)=>.2*Z(10*t,r)+p(.3,50)(t,r),r:[.15,.8],b:1}],[{l:1,d:t=>1-t,f:(t,r)=>C(r-t+.4),n:p(.8),b:1},{d:t=>sqrt(1-t),f:(t,r)=>1-r,n:p(1),r:[1/3,.9],b:4}],[{d:t=>C(PW(1-C(2*t),.2)),f:(t,r)=>C(r-t+.2),n:p(.2,40),w:1,b:2},{f:(t,r)=>P(r,.8),n:p(.5),w:1,r:[5/6,1.2],b:3}],[{d:t=>C(PW(1-C(2*t),.2)),f:(t,r)=>sqrt(1-MD(map(r,.2,.8,0,1),1)),n:p(.3,60,.5),w:2,r:[.25,.75]},{f:(t,r)=>P(r,0,.4),n:p(2,5,8),r:[.18,.9]}],[{f:(t,r)=>P(r,1,0,2/3),n:(t,r)=>X(abs(p(1)(t,r))/2,2*int(Z(10*t,50*r)<0)/3*P(r,.4,.3)),w:2,r:[0,.75],b:1,u:.5},{f:(t,r)=>P(r,0,1,1/3),n:(t,r)=>-P(X(r,t),.5,.4)*IN(abs(Z(t/2,10*r)))*.4-int(.5<r)*abs(p(1/3)(t,r)),r:[.25,1],b:1,u:.5}],[{d:t=>IN(C(2*t))**.1,f:(t,r)=>C(2*atan2(r-.2,t)/PI,0,.75),n:(t,r)=>Z(30*t,30*r)*P(abs(r-.5),0,.5),a:.25,b:1,u:.25},{d:t=>IN(C(2*t))**.1,f:(t,r)=>PW(2*abs(r-.5),.5),n:p(.7,18,25/18),r:[.25,1],a:.25,b:1,u:.25}],[{f:(t,r)=>IN(r)/2,n:(t,r)=>.3*abs(Z(30*t))-p(.5)(t,r),w:1,a:.2,b:3},{f:(t,r)=>P(r,1,.4),n:(t,r)=>abs(Z(30*t))/2,b:1},{f:(t,r)=>IN(r)/2,n:(t,r)=>abs(Z(30*t))**.6/2,a:.25,b:2,u:.5}],[{f:(t,r)=>r/2,n:(t,r)=>.5*abs(Z(20*t)),r:[.2,.8],o:2,a:.3,b:10}],[{f:(t,r)=>(r+1)/3,n:(t,r)=>1-abs(p(1/3)(t,r))+int(.4<abs(Z(15*t,15*r)))/3,w:1,u:.3,b:1},{f:(t,r)=>(r+1)/3,n:(t,r)=>-abs(p(.2)(t,r)),u:.3,b:1}]][s.ti].p(t=>(t.c=s.c,t.s=int(80*r+20),t.m=int(4*r)+4,t)),s.e=[0,.5,0].p(t=>R.g(0,.1,t))}L(o=0,l=10){let u=this.tp;var t=UZ(N(4).p(t=>{let r=u[I(t,u.l()-1)],s=r.c.l(),[p,n]=r.r||[0,1],e=N(l).p(t=>r.c[C(FL(P(t,0,l-1,p,n)*s),0,s-1)]),a=o?[hue,VB]:[LU,()=>1];var i=e.p(r=>a.p(t=>t(r)));return[i,0<t&&t<3?i:[]]}).ft(2));return o?WA(t[0],360,t[1]):SM(t[0])/6/l}}class FW{constructor(t,n,e,r){var a=this,s=(a.ot=V(),a.os=1,a.pe=[],t.p),i=(a.r=t.r,a.n=t.n,a.x=n,a.plt=e,a.res=r,a.sd=N(2).p(t=>R.d()),s.p(t=>{t.a*=D2R,t.b*=D2R,t.t*=D2R}),s[0].r),o=s[0].a/10,p=(s.p((s,t)=>{var p=I(3-t,e.tp.l()-1);N(1==t||2==t?2:1).p(t=>{var r=Y(s);r.x=n,r.u=V(0,1),r.w*=r.l,r.r=[i,r.r],r.a=[o,r.a],r.t*=1==t?-1:1,a.pe.push(new PE(r,e.tp[p],1,0,0,1))})}),1/a.X());a.pe.p(t=>t.sn=p),a.U(1)}U(r){this.a=r,this.pe.p(t=>{t.fw=1,t.U(r)})}CR(){return.0175*P(this.a,-1)**2}D(r,s,p){var t,n;-1!=this.a&&(t=this,r.u(),r.t(t.ot),n=t.d.c().e(2).mult(-1),r.rotateY(n.y),r.rotateX(n.x),r.k(t.os),t.pe.p(t=>t.D(r,s,p)),n=LC(O(LI(t.plt.c)),O(1),.5),r.fill(n),r.t(t.x.c().mult(t.CR())),r.sphere(t.a*t.CR()*2),r.o())}B(){return new BB(this.pe.p(t=>t.B(1))).s(this.os).t(this.ot)}V(){return this.pe.p(t=>t.v).ft()}X(){return this.V().r((t,r)=>X(t,r.m()))}}class SK{constructor(t,r){var s=this;s.ot=V(),s.os=1,s.s=[],s.li=t,K(r).p(t=>s[t]=r[t]),s.sd=R.n(0,1e4),s.fw=N(s.qf).p(t=>new FW(Y(s.fp),V(0,0,1),s.plt,s.res))}U(t,r,b){var i=this,o=(i.s=[],PW(t,.4)),h=(i.a=o,i.x=r.p.x,i.os=r.os,i.os),l=(i.ot=r.ot,b.lsf*i.lsr),t=R.d()<.5,r=r.v[t?1:3].c().sub(r.v[0]).n().r(i.x,(t?-1:1)*R.n(0,PI/6)).lerp(V(0,1),i.top?R.n(.5,.9):R.n(.2,.5)).n(),u=i.qf,c=b.rf/b.ll,s=C(P(LG(l,2),-1)/2+i.lbfr),s=1-I(1,l*(1-s)/c/u)*(c*u/l),u=I(u,FL(l*(1-s)/.3/c)),t=(l*=o,i.rsm*P(o,-1)*P(o,0,.1)),p=(s=P(o,1,0,s),u),n=(p-1)/2,e=[s].concat(N(u).p(t=>(1-s)/p*(1+o/3*A.sign(n-t)*SD(CL(abs(n-t)),FL(p/2))))),d=[0].concat(e.cs()),a=e.p((t,n)=>{var e=X(RD(t*h*o/P(i.res,0,1,.1,.01)),1),a=t/e;return N(e).p(t=>{var r={},s=n-1,p=a;return r.lfc=d[n]+(t+1)*a,r.l=p*l,r.lp=p*h*o,r.lpc=r.lfc*h*o,r.f=t==e-1&&0<=s?i.fw[s]:null,r.f&&(r.f.b=!0),r})}).ft(),m=(i.rs=[t,P(a[a.l()-1].lpc,.5,.1,.5)*t],V()),f=r;a.p((r,t)=>{var s=PW(2*b.us-1,1.5),p=(s<0&&(s*=3),V(0,1).m(s*P(i.cup?r.lfc:1-r.lfc,0,1,.25))),n=N(2).p(t=>Z(2*r.lpc,31*(i.sd+t))),e=f.c().s(V(0,1)).m(n[0]),e=e.c().a(f.c().s(e).m(n[1])).mult(P(abs(s),1,0,.1)),n=i.ot.c().a(m),s=n.c().sub(n.c().j(V(0,1))).m(P(i.cup?r.lfc:1-r.lfc,0,1,.5,.01)),n=V().a(p).a(s).a(e),p=(n.mult(r.lp/.1),f.c().a(n).n()),s=abs(p.b(f)),e=f.c().sl(p,SD(I(s,4*PI*r.lp),s)).n(),n=m.c().a(e.c().m(r.l));m=n,f=e,r.p=n,r.r=L(i.rs,SD(t,a.l()-1)),r.d=e,r.f&&r.f.b&&(r.f.U(P(o,.25+r.lfc/4,.75+r.lfc/4,-1)),r.f.os=c)}),a.filter(t=>t.f&&t.f.b).p((s,t)=>{var r=C(s.f.a/2+.5),p=c*r,n=s.d.c().o().r(s.d,i.ri+t*PI*2*PHI),t=(n.sl(s.d,P(r*pow(C((u-1-t)/P(u,7,2,4)),.35),0,1,.99,P(s.f.sd[1],0,1,.28,.38))),s.f.ot=n.c().m(p).a(s.p),n.c()),e=V(t.x,0,t.z).n(),e=(t.sl(e.m()<EP?V(1):e,P(r,0,1,0,P(s.f.sd[0],0,1,.5,.75))),s.f.d=t,s.p),r=n.c().sl(s.d,.5).m(.3*p).add(s.p),t=s.f.d.c().m(-.3*p).add(s.f.ot),n=s.f.ot,a=BZ(e,r,t,n,X(CL(p/P(i.res,0,1,.02,.002)),1));s.ss=a.p((t,r)=>({p:t,r:L(s.r,I(s.r,s.f.CR()*s.f.os*2),r/(a.l()-1))}))}),i.s=a}D(u,r,s){var c,f=this;f.a<EP||(c=(t,r,s,p,n,e)=>{t.u(),t.t(r),n&&t.sphere(p);n=s.c().sub(r).div(2),t.t(n),t.u(),s=n.c().e(),t.rotateZ(s.z),t.rotateX(s.x),r=2*n.m();t.cylinder(p,r),t.o(),t.t(n),e&&t.sphere(p),t.o()},u.u(),u.k(f.os),u.t(f.ot),N(f.s.l()).p(t=>{var r=SD(t,f.s.l()-1),[s,p,n]=f.plt.e,e=I(2*p,0),a=(u.fill((.7+s/2+e)*r,.4*r+.4+p,(.5+n/2+e)*r),t?f.s[t-1].p:V()),i=f.s[t].p,o=f.s[t].r,s=(c(u,a,i,o,0==t,1),f.s[t].f),l=f.s[t].ss;s&&s.b&&l&&N(l.l()-1).p(t=>{a=l[t].p,i=l[t+1].p,o=l[t].r,c(u,a,i,o,0!=t,0)})}),f.fw.filter(t=>t.b).p(t=>{t.D(u,r,s)}),u.o())}B(t=0){var r=this,s=t=>t.t(r.ot).s(r.os),p=r.fw.filter(t=>t.b),n=p.p(t=>({f:t,bb:s(t.B())})),p=s(new BB(r.s.p(t=>[t.p].concat(t.f&&t.f.b&&t.ss?t.ss.p(t=>t.p):[])).ft()).a(p.p(t=>t.B())));return t?[p,n]:p}}class PG{constructor(t){var r=this;r.pp=t,r.p={},r.p.res=t.res,r.qr=[1,t.qs],r.p.top=t.bu&&!t.olb,r.pi=r.p.top?[t.qlm-1]:N(t.bu?t.qlb:t.qlm),r.p.rsm=P(P(t.ll,100,750)**.5,-1,1)*R.n(.035,.05)*t.wlf,r.p.fp=new SSM(SFP).G(.15),r.p.plt=new PA(R.i(2,5),r.p.res),r.p.cup=R.d()<.5}G(){for(var r=this,t=RD(L(r.qr,R.d()**.5)),s=Y(r.pi).p(t=>[t,0]),p=s.l(),n=[];n.l()!=t&&0!=s.l();)s=SF(s).p(([t])=>[t,(0==n.l()?1:int(t%2!=n[0]%2))*pow(t/(p-1),r.pp.bu?2:P(r.pp.htf,.05,.25,.25,2))+.25*R.g()]).st(1,0),n.splice(0,0,s.splice(0,1)[0][0]);var e={};return n.p(t=>{r.p.qf=X(RD(r.pp.qfs*R.n(.8,1.2)),1),r.p.lsr=R.n(.85,1.15),r.p.lbfr=R.g(0,.05),r.p.ri=R.d()*PI*2,e[t]=new SK(t,Y(r.p))}),e}}class PL{constructor(r,s,p,t=V()){var n=this,e=(n.os=1,n.lv=[],n.bu=[],n.th=0,n.p=r,n.x=s.n(1),n.t=p,n.ot=t,PL.sg||(PL.sg=new PG(r)),1/n.X()),a={s:int(30*r.res+10),e:PL.sg.p.plt.e,m:8*int(r.res)+8};n.lv=N(r.qlm).p(t=>new PE({x:s,u:p,t:t%2?PI:0,r:[.5,r.rl]},a,null,!r.bu,!r.bu&&0<t,e)),n.bu=N(r.bu?2:0).p(t=>new PE({x:s,u:p,t:(t+.5)*PI,d:0},a,null,0,0,e)),n.sk=PL.sg.G(),n.U(1)}U(e){var a=this,i=a.p,o=1/(i.qlm+i.qlg-1),l=i.bu?pow(P(e,o*i.qlb),.5):0;a.bu.p(t=>{var r=i.wtf*l,s=i.htf*l,p=i.dtf*l,n=i.rt,e=NN(atan(p/(2*s*n))),e=(t.p.a=[e,e],t.p.b=NN(-atan(p/(2*s*(1-n)))-e),sqrt((p/2)**2+(s*n)**2)),s=(t.p.l=e+sqrt((p/2)**2+(s*(1-n))**2),sqrt((p/2)**2+(r/2)**2)),n=acos(p/2/s),r=(t.p.rc=NN(s/(2*cos(n))),t.p.w=2*t.p.rc*(PI-2*n),NN(e/t.p.l));t.p.r=[r,r],t.U(1),t.age=l}),a.th=0,a.lv.p((t,r)=>{var s=r/(i.qlm-1),p=P(e,r*o,r*o+o*i.qlg),n=X(p-1,0),p=C(p),s=(t.p.l=P(pow(s,i.eli),0,1,i.lmm)*pow(p,i.ela)*(i.bu&&!i.olb&&r<i.qlb?i.htf:1),t.p.w=t.p.l*i.wlf,t.p.d=P(p,1,0,i.dlm),X(p*i.am*(i.bu&&r<i.qlb?i.olb?.5:.25:1),i.bu&&r<i.qlb?pow(l,.3)*atan(i.wtf/2/i.htf/i.rt):0)+2*n*5*D2R*(i.bu?i.olb?1:.25:P(i.htf,.2,0)));t.p.a=[s,s],t.p.b=pow(p,i.eba)*i.bm,a.th+=p*i.htf*int(0<r),t.ot=a.x.c().m(i.bu?int(r>=i.qlb)*i.htf*l:a.th).a(a.t.c().m((i.bu?0:p*i.wtf/2)*(r%2?-1:1))),t.p.ht=i.htf,t.p.wt=i.wtf,t.p.dt=i.dtf,t.p.lp=a.lv[r-1],t.U(p)}),E(a.sk).p(([,t])=>{var r=a.lv[t.li];t.U(r.age*pow(P(e,.4,.9),2),r,i)})}D(s,p,n){var e=this;s.u(),s.t(e.ot),s.k(e.os),e.bu.p(t=>t.D(s,p,n)),e.lv.p((t,r)=>{t.D(s,p,n),r in e.sk&&e.sk[r].D(s,p,n)}),s.o()}B(t=0){var r=this,s=t=>t.s(r.os).t(r.ot),[p,n]=[r.bu,r.lv].p(t=>t.p(t=>t.B())),[e,a]=UZ(E(r.sk).p(([,t])=>t.B(1))),[e,p]=[[p,n,e],[p,n]].p(t=>s(new BB(t.ft())));return(a=a.ft()).p(t=>t.bb=s(t.bb)),t?[e,p,a]:e}X(){var t=this.p;return 1+(t.bu?1:t.qlm)*t.htf}}PL.sg=null;class PSG{constructor(t){p=new SSM(SPP).G(),p.res=t,p.qpa=X(RD(p.qpa),1),p.qlm=X(RD(p.qlm),2),p.qlg=X(p.qlg,1.5),p.qfs=X(RD(p.qfs),1),p.bu=.5<p.bu,p.am=C(p.am,15*D2R,75*D2R),p.bm=I(p.bm,75*D2R)*(p.bu&&!p.olb?.2:1),p.lmm=abs(p.lmm),p.wlf=X(p.wlf,.08),p.rl=abs(p.rl),p.dlm=C(p.dlm),p.htf=C(p.htf,p.bu?.15:.01,p.bu?.65:.3),p.wtf=X(p.wtf,.01),p.dtf=X(p.dtf,.01),p.rt=C(p.rt,.1,.9),p.olb=.5<p.olb,p.qlb=X(1,p.qlm-2),p.qla=p.qlm-p.qlb,p.qs=C(RD(p.qs),1,p.bu&&!p.olb?1:p.qlb),p.ll=C(p.ll,100,750),p.rf=C(p.rf,20,75),p.lsf=C(.8*p.lsf,.5,2),p.us=C(p.us),this.p=p}}class PS{constructor(t,r,s,p,n,e,a,i,u){var o=this,l=(o.ot=V(),o.os=1,PS.psg||(PS.psg=new PSG(t)),o.p=Y(PS.psg.p),o.p.us=P(o.p.us,0,1,p),o.p.rf=X(o.p.rf/o.p.ll,n)*o.p.ll,o.p.lsf=C(o.p.lsf,e,a),o.p.qpa=X(o.p.qpa,r),o.p.qfs=X(o.p.qfs,i),o.L(o.p.qpa,s,u));o.s=l.p((t,r)=>{var s=P(LG(o.p.wtf*o.p.dtf,10),-4,-1,.01,.073),r=l[r].p,r=V(r.x*s,0,r.y*s),s=PI/2*C(l.l()/100,.1,.2)*pow(t.x,2),p=V(0,1).o(r);return new PL(o.p,V(0,1).r(p,s),V(cos(t.t),0,sin(t.t)).r(p,s),r)}),o.s.p((t,r)=>t.U(.95*PW(l[r].r,.85)))}L(t,r=.2,s=1,p=10){var n=sqrt(t)/2,e=N(t).p(t=>({p:V(R.n(-n,n),R.n(-n,n))})),[a,i]=MM(e.p(t=>-t.p.m()));for(e.p(t=>{t.r=NN(P(PW(P(-t.p.m(),a,i),s),0,1,r),1),t.a=PI*t.r**2});0<p--;){var o=(t,r)=>t.r+r.r-t.p.dist(r.p),l=s=>e.p((t,r)=>t.p.a(s[r]));l(i=e.p((s,p)=>e.p((t,r)=>s.p.c().sub(t.p).m((p!=r?X(o(s,t),0):0)*s.a/(s.a+t.a)*.8)).r((t,r)=>t.add(r),V()))),l(i=e.p((s,p)=>{var t=e.p((t,r)=>[p!=r?o(s,t):0,t]).st(0,0)[0];return t[1].p.c().sub(s.p).m(.5*X(-t[0],0))}))}var t=e.p((s,p)=>(s.t=e.p((t,r)=>t.p.c().sub(s.p).m(p!=r&&-.1<o(s,t)?s.a/(s.a+t.a):0)).r((t,r)=>t.a(r),V(R.g(0,.01),R.g(0,.01))).heading()+PI/2,s.t)),u=WA(t,PI,e.p(t=>t.a)),o=e.r((t,r)=>t.a(r.p.c().mult(r.a)),V()).div(SM(e.p(t=>t.a))),c=e.r((t,r)=>X(t,r.p.dist(o)),0);return e.p(t=>{t.t=LW(t.t,u,.5,PI)+R.i(0,1)*PI,t.p.sub(o),t.d=t.p.m(),t.x=SD(t.d,c)}),e}D(r,s,p,t=V(),n=0,e=V(0,1),a=1){r.u(),r.t(t);t=e.n(1).e(1);r.rotateZ(t.z),r.rotateY(n),r.rotateX(t.x),r.k(a),r.t(this.ot),r.k(this.os),this.s.p(t=>t.D(r,s,p)),r.o()}B(r=V(),s=1){var p=this,n=t=>t.s(p.os).t(p.ot).s(s).t(r),[t,e,a]=UZ(p.s.p(t=>t.B(1)));return[t,e]=[t,e].p(t=>n(new BB(t))),(a=a.ft()).p(t=>{t.bb=n(t.bb),t.o=t.bb.o(),t.d=t.bb.d()}),[t,e,a]}}PS.psg=null;class PT{constructor(r){var s=this,[t,p,n,e,a]=(s.ot=V(),s.os=1,[r.o.y,r.t,r.m,r.g,r.k]);s.p=r,s.v=[[t+p,[e[1]*(1-a),e[1]]],[t+p*(1-n),[e[1]*(1-a),e[1]*(1-a)],p*n],[t+p*(1-n),[0,e[1]*(1-a)]],[t,e,p,r.s,r.e],[t,[0,e[0]]]].p(t=>s.C(r.o.x,r.o.z,r.u,...t)).ft(1)}C(r,s,o,l,u,c=0,f=1,b=1){return N(f).p(i=>N(o).p(p=>{var[n,e,a]=UZ(N(2).p(t=>[P(PW((t+i)/f,b),0,1,u[0],u[1]),P((t+i)/f,0,1,l,l+c),V(cos(2*PI*(t+p)/o)+r,0,sin(2*PI*(t+p)/o)+s)]));return N(2).p(s=>N(3).p(t=>{var t=s+t,r=t%2,t=int(t/2);return[a[r].x*n[t],e[t],a[r].z*n[t],(p+r)/o,(i+t)/f]}))})).ft(2)}D(s,p,n,t=V(),r=1,e=O("#80460F")){s.u(),s.t(t),s.k(r),s.t(this.ot),s.k(this.os),s.beginShape(TRIANGLES),n&&!p&&s.texture(_X),this.v.p(t=>t.p(t=>{p&&s.fill(O(e));var r=n&&!p?[t[3]*_X.width,t[4]*_X.height]:[];s.vertex(t[0],t[1],t[2],...r)})),s.endShape(CLOSE),s.o()}B(t=V(),r=1){return new BB(this.v.ft(1).p(t=>V(...t))).s(this.os).t(this.ot).s(r).t(t)}}class CP{constructor(){var t=this,r={v:PI/4,res:1,t:V(),s:.25,n:.01,f:9,g:1,l:1,ni:15,mi:.4,mp:.2,ui:0,d:1,fi:0,si:.5,sx:2,p:400,wi:1};t.p=r,t.sd=N(100).p(t=>R.d()),r.m=R.i(0,2),t.E(),t.G(),t.C(),t.O()}E(){var t=this.p;0==t.m&&(t.si=1.3,t.ni=8),1==t.m&&(t.res=0,t.si=.8,t.r=.08,t.ui=.5,t.p=500),2==t.m&&(t.s=1,t.fi=.15,t.p=600,t.l=.25,t.g=.6)}G(){var r,s,p=this,n=p.p,[t,e]=(p.s=new PS(n.res,n.ni,n.mi,n.ui,n.fi,n.si,n.sx,n.wi,n.mp),p.b=p.s.B(n.t,n.s),p.b[2].r((t,r)=>{var s=C(r.f.a);return[t[0].a(r.o.c().mult(s)),t[1]+s]},[V(),0]));p.d=t.div(e).sub(p.b[1].o()),n.m<2&&(r=new BB(p.b[2].p(t=>t.o)),s=V(X(abs(r.i.x),abs(r.x.x)),X(abs(r.i.z),abs(r.x.z))).dist(V()),p.f=SF(p.b[2]).p(t=>(t.w=C(t.f.a)*(0==n.m?pow(t.o.m()/p.b[0].d().m(),.5)*P(t.f.d.dot(t.o.c().sub(p.b[1].o()).n()),-1):IN(P(t.o.y,r.i.y,r.x.y),p.d.y<0)*P(t.o.dist(V(0,t.o.y)),s,0,1,.5)),t)).st(["w"],0)),2==n.m&&(t=X(X(p.s.s.p(t=>t.ot.m())),.04),t=(e=[.75*(t*=P(t,.05,.1,2,1)),1.15*t])[1]*C(R.g(1,.2,1,2),.5,2)*2/3,p.t=new PT({o:V(0,.9*-t),s:8,t:t,g:e,u:32,e:C(R.g(1,.2,1,2),.5,2),k:.1,m:.2}),p.b[0].a(p.t.B(n.t,n.s)))}C(){var r,t,s,p,n,e=this,a=e.p;0==a.m&&([a.c,a.o,a.u]=e.T(e.f[0].bb.o(),X(e.f[0].bb.d().m(),.011),e.f[0].f.d,e.b[1].o(),a.v,V(0,-1),.3),a.f=X(e.b[0].n().p(t=>t.dist(a.c)))),1==a.m&&(n=new BB([V(-a.r,e.b[0].i.y,-a.r),V(a.r,e.b[0].x.y,a.r)]),a.o=n.o(),n.a(e.f[0].bb),[a.c,a.o,a.u,a.v,t]=e.L(n,V(0,1),2,1,V(1),a.o),s=a.c.dist(a.o),p=n.d().m()/2,a.n=X(s-p,.01),a.f=s+p),2==a.m&&(n=e.b[0],r=e.d.c().j(V(0,1),1).n().r(V(0,1),R.g(0,PI/6)),s=e.b[0].d().ar(),s=SD(X(s)-I(s),SM(s)/3),[a.c,a.o,a.u,a.v,t]=e.L(e.b[0],r,4,1,V(0,-1),0,1),t=X(e.b[0].n().p(t=>t.j(r).m())),a.n=X(a.c.dist(a.o)-t,.01),a.f=a.c.dist(a.o)+t,p=e.W(a.c,a.o,a.u,a.v,e.t.B(a.t,a.s).o()).y,(n=e.sd.at(-2)<.5)&&.8<=p&&p<.92&&(p+=.02),a.fr=.92<p||.8<=p&&s<.1?null:p<.8?[0,0,1,p,0]:[1-p,1-p,2*p-1,2*p-1,n?.5:.02])}O(){let t=this.p;for(var r=PL.sg.p.plt.L(1);!t.bg||abs(WD(r,hue(LC(O(t.bg),O(t.bgs),.1)),360))<10;){let r=R.d();[t.bg,t.bgs,t.bgd]=[["#F0D3C3","#F5DCB6","#FAE7B4","#E4ECCD","#DAE5EB","#F7DCE1"],["#FF0000","#B33B00","#D9A300","#008509","#0000FF","#940085"],["#690000","#662200","#403000","#004004","#000D57","#57004F"]].p(t=>CM(r,t,[2,1.5,1.5,1,2,1]))}let s=0;var p=PL.sg.p.plt.L(),n=p-(LU(t.bg)-.01);0<n?(t.bg=LC(O(t.bg),O(t.bgd),P(n,.07,.15,.2,.1)),t.g*=.9,t.d*=1.1):(2==t.m||p<LU(t.bg)-.05)&&(s=.2),t.g*=P(saturation(t.bg),30,90,1,t.fr?t.fr[0]?1:.85:.525),t.bg0=LC(O(t.bg),O(t.bgs),t.fr?t.fr[0]?.27:0<n?.3:.25:s),t.bg1=AL(t.bg,.25);let e=O(t.bg)._array;e=CC._rgbaToHSLA(e),e[0]=WR(e[0]+(2*R.i(0,1)-1)*R.n(.05,.15),1),e=CC._hslaToRGBA(e),e[3]=.04*t.g,t.fg=e}S(t){var r=this.p;t.perspective(r.v,1,r.n,r.f),t.camera(...[r.c,r.o,r.u].p(t=>t.ar()).ft())}D(p,n,e){var a=this,s=a.p,i=(t,r,s=0)=>a.s.D(p,n,e,t,s,V(0,1),r);0==s.m&&i(s.t,s.s),1==s.m&&N2(3,3).p(([t,r])=>{i(s.t.c().a(V((t-1)*s.r,0,(r-1)*s.r)),s.s,a.sd[3*t+r]*PI*2)}),2==s.m&&(i(s.t,s.s),a.t.D(p,n,e,s.t,s.s,LC(LC(O("#80460F"),O("#4A4628"),P(PL.sg.p.plt.e[2],-.1,.2)),O(a.p.bg),P(PL.sg.p.plt.e[1],-.1,.2,0,.25))))}T(t,r,u,s,p,n,e,c=1){p*=sqrt(2);var a=s.c().sub(t),i=3*asin(sqrt(a.m()**2/r**2))*.8,i=(p=I(p,i||p),acos(SD(a.m()**2+r**2-(r*cos(p/3)+sqrt(X(a.m()**2-r**2*sin(p/3)**2,0)))**2,2*a.m()*r))),s=t.c().lerp(s,sin(p/6)/sin(PI-p/6-i)*r/a.m()*C(1-e)),o=a.n(1).o(u),p=a.n(1).r(o,i).c().m(r).a(t),l=s.c().sub(p).n(),f=n.n(1).sub(n.n(1).j(l)).n(),e=N(4).p(t=>o.c().r(l,PI/4+PI/2*t)).p(t=>[t.dot(f),t]).st(0,0)[0][1];return[p,s,f.sl(e,c)]}L(t,r,s,p,n,e,a=0){var i=r.n(1).o(n).o(r),n=(t=[t].ft().p(t=>IO(t,BB)?t.n(a):t).ft(),new BB(t)),n=(e=e||n.o(),X(n.n(a).p(t=>t.j(r).m()))),o=r.c().m(n*s).a(e),l=r.n(1).mult(-1);return[o,e,i,I(2*atan(tan(X(t.p(t=>{var t=t.sub(o),r=abs(WR(t.n(1).j(l,1).n().b(i)+PI/4,PI/2)-PI/4);return atan(cos(r)*t.c().j(l,1).m()/t.c().j(l).m())})))/p),PI),n]}W(t,r,s,p,n){var e=t.c().sub(r).n(),a=n.c().sub(r).j(e,1),i=tan(p/2)*r.c().sub(t).m();return V(...N(2).p(t=>{var r=a.c().j(s,1-t);return IN(P(r.m()*A.sign(r.n(1).dot(s.c().r(e.n(1),(1-t)*PI/2)))/i,-1),1-t)}))}}var _B,_NB,_V,_C,_X,_F,R=new RNG,S=R.i(0,1e10),B={},_N=500,M={d:{M:0},x:{l:1,d:1},s:{M:2,d:1,F:1}},_M=[],_I=0;function setup(){O=color,LC=lerpColor,randomSeed(S),noiseSeed(S),createCanvas(D,D),colorMode(RGB,1),noStroke(),[20,100].p(t=>B[t]=(new BL).S(t,t,1));var t=s=>{let p=G(0,s,s,1);return N2(s,s).p(([t,r])=>p.set(t,r,O(r/(s-1),t/(s-1),0))),p.updatePixels(),p};let r=t(20);B[20].A(r,r,0,1),_F=128<r.get(0,0)[0],r=null,_C=new CP,K(B).p(t=>B[t].D()),K(M).p(t=>{M[t].sh=CS("uniform mat4 uProjectionMatrix,uModelViewMatrix;varying vec3 P;void main(){P=aPosition;X=aTexCoord;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(P,1.);}","#extension GL_OES_standard_derivatives:enable\nvarying vec3 P;uniform int M,F;void main(){vec4 o;if(M==0){float n=gl_DepthRange.near,f=gl_DepthRange.far,d=((1.-pow((gl_FragCoord.z-n)/(f-n),4.))*255.+1.)/256.;vec3 m=normalize(cross(dFdx(P),dFdy(P)));o=vec4(d,m.x,m.y,1.);};if(M==2){o=vec4(X.x,X.y,0.,1.);}if(F==1){float t=o.x;o.x=o.y;o.y=t;}gl_FragColor=o;}")}),_X=t(RD(P(_C.p.res,0,1,4,128))),K(M).p(t=>{var r=G(1,_C.p.p,_C.p.p,1);_C.S(r),r.noSmooth(),r._renderer.drawingContext.getExtension("OES_standard_derivatives"),M[t].fb=r});E(M).p(([,p],t)=>{"M"in p&&(p.fb.shader(p.sh),p.sh.u("M",p.M),p.F&&p.sh.u("F",p.F)),T(p.fb,t=>{var r,s;t.clear(),t=t,r=p.l,s=p.d,t.u(),t.k(1/_C.p.p),_C.D(t,r,s),t.o()}),p.fb.loadPixels(),p.px=p.fb.pixels});let p=SF(N(_C.p.p**2).p(t=>[t,R.n(-.01,.01),R.n(.9,1.1)]),1),s=(_M=N(_C.p.p**2).filter(t=>M.d.px[4*t]>EP).p(t=>{var r=4*t,s=255;return{i:t,j:p[t][0],p:V(t%_C.p.p/_C.p.p,1-FL(t/_C.p.p)/_C.p.p),d:C(M.d.px[r]/s+p[t][1]),n:V(M.d.px[2+r]/s*2-1,M.d.px[1+r]/s*2-1).rotate(PI/2),r:M.x.px[r]/s,g:M.x.px[1+r]/s,b:M.x.px[2+r]/s,s:V(M.s.px[1+r]/s*2-1,M.s.px[r]/s*2-1,0),o:p[t][2]}}).st("j").st("d"),K(M).p(t=>{M[t].fb.remove(),M[t].fb=null}),_V=G(0,D,D),GR(_V,_C.p.bg0,_C.p.bg1,[0,0,1,1,0],[0,0,1,0,0],200),_C.p.fr&&GR(_V,O(_C.p.bg),O(1),_C.p.fr,_C.p.fr[0]?null:[0,0,1,0,0],200),_B=CL(_M.l()/_N),t=>_M[I(t*_B,_M.l()-1)].d),n=N(_N).p(t=>s(t+1)-s(t));t=_C.p.m?0:P(n.iiw(.5)/_N,.3,.5,-.2,0);_NB=_N*(.7+t),B[0]=(new BL).S(D,D),B[0].P(_NB,40)}function draw(){B[0].p.includes(_I)&&_C.p.l&&B[0].A(_V,_V,P(_I,0,_NB,.001,1e-5)*_C.p.l*D,1,_C.p.fg),_I++,T(_V,p=>{p.u();var n=1/_C.p.p,e=V(1,-1).mult(n/2);_M.splice(0,_B).p(t=>{p.stroke(t.r,t.g,t.b,.5),p.strokeWeight(n*P(noise(5*t.p.x,5*t.p.y),0,1,t.d/3)*2*_C.p.d);var r=t.p.c().mult(1e3),r=t.p.c().a(e).a(V(Z(r.c().a(V(0,37.173)).rotate(31)),Z(r.c().rotate(-37))).mult(.005)),t=t.s.c().mult(n*t.o),s=r.c().a(t),r=r.c().sub(t);p.line(s.x,s.y,r.x,r.y)}),p.o()}),T(this,t=>{t.image(_V,0,0,1,1)}),_M.l()||noLoop()}
    //APP_END//
  </script>
  <script>
    // Log relevant information to the console.
    console.log("Cattleya Â© 2022 by Ben Snell is licensed under CC BY-NC 4.0");
    let metadata = {};
    let values = META.split("_").concat(tokenData.hash);
    ['Artist','Title','Version','Hash'].map((key, index) => metadata[key] = values[index]);
    console.log(metadata);
  </script>
</body>

</html>